{"version":3,"file":"TopBannerSkipLink.test.stories-CAcKvRrj.js","sources":["../../../../apps/ds-playground/src/stories/__tests__/TopBannerSkipLink.test.stories.tsx"],"sourcesContent":["import { Meta, StoryFn, StoryObj } from '@storybook/react';\nimport { expect, fireEvent, userEvent, within } from '@storybook/test';\n\nimport { dsI18n } from '@skatteetaten/ds-core-utils';\n\nimport { wrapper } from './testUtils/storybook.testing.utils';\n// eslint-disable-next-line @nx/enforce-module-boundaries\nimport { TopBannerSkipLink } from '../../../../../libs/ds-layout/src/TopBannerSkipLink/TopBannerSkipLink';\n// eslint-disable-next-line @nx/enforce-module-boundaries\nimport { TopBannerSkipLinkProps } from '../../../../../libs/ds-layout/src/TopBannerSkipLink/TopBannerSkipLink.types';\nimport { webComponent } from '../../../.storybook/webcomponent-decorator';\n\nconst meta = {\n  component: TopBannerSkipLink,\n  title: 'Tester/TopBanner/TopBannerSkipLink (intern)',\n  argTypes: {\n    // Baseprops\n    key: { table: { disable: true } },\n    ref: { table: { disable: true } },\n    className: { table: { disable: true } },\n    id: { table: { disable: true } },\n    lang: { table: { disable: true } },\n    'data-testid': { table: { disable: true } },\n    // Props\n    children: { table: { disable: true } },\n    shadowRootNode: {\n      table: { disable: true },\n    },\n    target: { table: { disable: true } },\n  },\n} satisfies Meta<typeof TopBannerSkipLink>;\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nconst skipLinkText = 'ds_layout:topbanner.SkipLinkText';\nconst defaultArgs: TopBannerSkipLinkProps = {};\n\nexport const WithRef = {\n  name: 'With Ref (FA1)',\n  args: {\n    ref: (instance: HTMLAnchorElement | null): void => {\n      if (instance) {\n        instance.id = 'dummyIdForwardedFromRef';\n      }\n    },\n  },\n  argTypes: {\n    ref: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const skipLink = canvas.getByRole('link');\n    await expect(skipLink).toHaveAttribute('id', 'dummyIdForwardedFromRef');\n  },\n} satisfies Story;\n\nexport const WithAttributes = {\n  name: 'With Attributes (FA2-5)',\n  args: {\n    id: 'htmlId',\n    className: 'dummyClassname',\n    lang: 'nb',\n    'data-testid': '123ID',\n  },\n  argTypes: {\n    id: { table: { disable: false } },\n    className: { table: { disable: false } },\n    lang: { table: { disable: false } },\n    'data-testid': { table: { disable: false } },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const skipLink = canvas.getByRole('link');\n    await expect(skipLink).toHaveAttribute('id', 'htmlId');\n    await expect(skipLink).toHaveClass('dummyClassname');\n    await expect(skipLink).toHaveAttribute('lang', 'nb');\n    await expect(skipLink).toHaveAttribute('data-testid', '123ID');\n    skipLink.focus();\n  },\n} satisfies Story;\n\nexport const Defaults = {\n  name: 'Defaults (B2)',\n  args: {\n    ...defaultArgs,\n  },\n  argTypes: {},\n  parameters: {\n    imageSnapshot: {\n      focus: `${wrapper} a`,\n    },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const skipLink = canvas.getByRole('link', {\n      name: dsI18n.t(skipLinkText),\n    });\n    expect(skipLink).toBeInTheDocument();\n    expect(skipLink.tagName).toBe('A');\n  },\n} satisfies Story;\n\nconst mainId = 'hovedinnhold';\nconst MainTemplate: StoryFn<typeof TopBannerSkipLink> = (args) => (\n  <>\n    <TopBannerSkipLink {...args} />\n    <main id={mainId}>{'Hovedinnholdet på siden'}</main>\n  </>\n);\n\nexport const WithTargetAndChildren = {\n  render: MainTemplate,\n  name: 'With Target And Children (A3 delvis)',\n  args: {\n    ...defaultArgs,\n    target: `#${mainId}`,\n    children: 'Snarvei til hovedinnhold',\n  },\n  argTypes: {\n    target: { table: { disable: false } },\n    children: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const skipLink = canvas.getByRole('link', {\n      name: 'Snarvei til hovedinnhold',\n    });\n    await expect(skipLink).toBeInTheDocument();\n    await expect(skipLink).toHaveAttribute('href', `#${mainId}`);\n    await fireEvent.click(skipLink);\n    const main = canvas.getByRole('main');\n    await expect(main).toHaveFocus();\n  },\n} satisfies Story;\n\nexport const ClickSkipLink = {\n  render: MainTemplate,\n  name: 'Click SkipLink (A3, C1 delvis)',\n  args: {\n    ...defaultArgs,\n  },\n  argTypes: {},\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const main = canvas.getByRole('main');\n    const skipLink = canvas.getByRole('link', {\n      name: dsI18n.t(skipLinkText),\n    });\n    skipLink.focus();\n    await fireEvent.click(skipLink);\n    await expect(main).toHaveFocus();\n  },\n} satisfies Story;\n\nconst TemplateWithShadowDom: StoryFn<typeof TopBannerSkipLink> = (args) => {\n  const element = document.querySelector('skiplink-customelement');\n  const shadowRoot = element?.shadowRoot;\n  return (\n    <div>\n      <TopBannerSkipLink {...args} shadowRootNode={shadowRoot ?? undefined} />\n      <main>{'Hovedinnholdet på siden'}</main>\n    </div>\n  );\n};\n\nexport const WithShadowDom = {\n  render: TemplateWithShadowDom,\n  name: 'With ShadowDom',\n  args: {\n    ...defaultArgs,\n  },\n  decorators: [webComponent],\n  parameters: {\n    imageSnapshot: {\n      disable: true,\n    },\n    customElementName: 'skiplink-customelement',\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    //skipLink finnes ikke utenfor shadowDom\n    await expect(canvas.queryByRole('link')).not.toBeInTheDocument();\n\n    const customElement = canvasElement.querySelector(`skiplink-customelement`);\n    await expect(customElement).toBeInTheDocument();\n    const skipLink =\n      customElement?.shadowRoot && customElement.shadowRoot.querySelector('a');\n\n    await expect(skipLink).toBeInTheDocument();\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    await userEvent.click(skipLink!);\n\n    const main =\n      customElement?.shadowRoot &&\n      customElement.shadowRoot.querySelector('main:focus');\n    await expect(main).toBeInTheDocument();\n  },\n} satisfies Story;\n"],"names":["meta","component","TopBannerSkipLink","title","argTypes","key","table","disable","ref","className","id","lang","children","shadowRootNode","target","skipLinkText","defaultArgs","WithRef","name","args","instance","parameters","imageSnapshot","play","canvasElement","skipLink","within","getByRole","expect","toHaveAttribute","WithAttributes","toHaveClass","focus","Defaults","wrapper","dsI18n","t","toBeInTheDocument","tagName","toBe","mainId","MainTemplate","jsxs","Fragment","jsx","WithTargetAndChildren","render","canvas","fireEvent","click","main","toHaveFocus","ClickSkipLink","TemplateWithShadowDom","element","document","querySelector","shadowRoot","undefined","WithShadowDom","decorators","webComponent","customElementName","queryByRole","not","customElement","userEvent","docs","source","originalSource"],"mappings":"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"}