{"version":3,"file":"PopoverTrigger.test.stories-C4-wtGRA.js","sources":["../../../../apps/ds-playground/src/stories/__tests__/PopoverTrigger.test.stories.tsx"],"sourcesContent":["import { JSX } from 'react';\n\nimport { Meta, StoryObj } from '@storybook/react';\nimport { expect, fn, userEvent, waitFor, within } from '@storybook/test';\n\nimport { Popover } from '@skatteetaten/ds-overlays';\n\nimport { category, htmlEventDescription } from '../../../.storybook/helpers';\nimport { SystemSVGPaths } from '../utils/icon.systems';\n\nconst verifyAttribute =\n  (attribute: string, expectedValue: string) =>\n  async ({ canvasElement }: { canvasElement: HTMLElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const iconButton = canvas.getByRole('button');\n    await expect(iconButton).toBeInTheDocument();\n    await expect(iconButton).toHaveAttribute(attribute, expectedValue);\n  };\n\nconst meta = {\n  component: Popover.Trigger,\n  title: 'Tester/Popover/Trigger',\n  argTypes: {\n    // Baseprops\n    ref: { table: { disable: true } },\n    className: { table: { disable: true } },\n    id: { table: { disable: true } },\n    lang: { table: { disable: true } },\n    'data-testid': { table: { disable: true } },\n    // Props\n    size: { table: { disable: true } },\n    svgPath: {\n      options: Object.keys(SystemSVGPaths),\n      mapping: SystemSVGPaths,\n      table: { disable: true },\n    },\n    //HTML\n    title: { table: { category: category.htmlAttribute, disable: true } },\n    // Aria\n    ariaDescribedby: { table: { category: category.aria, disable: true } },\n    //Events\n    onFocus: { ...htmlEventDescription, table: { disable: true } },\n    onClick: { ...htmlEventDescription, table: { disable: true } },\n    onBlur: { ...htmlEventDescription, table: { disable: true } },\n  },\n  render: (args): JSX.Element => (\n    <Popover>\n      <Popover.Trigger {...args} />\n    </Popover>\n  ),\n} satisfies Meta<typeof Popover.Trigger>;\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nexport const WithRef = {\n  name: 'With Ref (FA1)',\n  args: {\n    ref: (instance: HTMLButtonElement | null): void => {\n      if (instance) {\n        instance.id = 'dummyIdForwardedFromRef';\n      }\n    },\n  },\n  argTypes: {\n    ref: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toHaveAttribute('id', 'dummyIdForwardedFromRef');\n  },\n} satisfies Story;\n\nexport const WithAttributes = {\n  name: 'With Attributes (FA2-5)',\n  args: {\n    id: 'htmlId',\n    className: 'dummyClassname',\n    lang: 'en',\n    'data-testid': '123ID',\n  },\n  argTypes: {\n    id: { table: { disable: false } },\n    className: { table: { disable: false } },\n    lang: { table: { disable: false } },\n    'data-testid': { table: { disable: false } },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toHaveAttribute('id', 'htmlId');\n    await expect(button).toHaveClass('dummyClassname');\n    await expect(button).toHaveAttribute('lang', 'en');\n    await expect(button).toHaveAttribute('data-testid', '123ID');\n  },\n} satisfies Story;\n\nexport const WithAriaDescribedby = {\n  name: 'With AriaDescribedby',\n  args: {\n    ariaDescribedby: 'araiDescId',\n  },\n  argTypes: {\n    ariaDescribedby: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: {\n      disable: true,\n    },\n  },\n  play: verifyAttribute('aria-describedby', 'araiDescId'),\n} satisfies Story;\n\nexport const WithEventHandlers = {\n  name: 'With EventHandlers',\n  args: {\n    onFocus: fn(),\n    onBlur: fn(),\n    onClick: fn(),\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n  play: async ({ args, canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const iconButton = canvas.getByRole('button');\n    await expect(iconButton).toBeInTheDocument();\n    iconButton.focus();\n    await waitFor(() => expect(args.onFocus).toHaveBeenCalled());\n    await userEvent.tab();\n    await waitFor(() => expect(args.onBlur).toHaveBeenCalled());\n    await userEvent.click(iconButton);\n    await waitFor(() => expect(args.onClick).toHaveBeenCalled());\n  },\n} satisfies Story;\n"],"names":["verifyAttribute","attribute","expectedValue","canvasElement","iconButton","within","getByRole","expect","toBeInTheDocument","toHaveAttribute","meta","component","Popover","Trigger","title","argTypes","ref","table","disable","className","id","lang","size","svgPath","options","Object","keys","SystemSVGPaths","mapping","category","htmlAttribute","ariaDescribedby","aria","onFocus","htmlEventDescription","onClick","onBlur","render","args","jsx","WithRef","name","instance","parameters","imageSnapshot","play","button","WithAttributes","toHaveClass","WithAriaDescribedby","WithEventHandlers","fn","focus","waitFor","toHaveBeenCalled","userEvent","tab","click","docs","source","originalSource"],"mappings":"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"}