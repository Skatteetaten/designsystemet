{"version":3,"file":"TopBannerSkipLink.test.stories-CPZ026d1.js","sources":["../../../../apps/ds-playground/src/stories/__tests__/TopBannerSkipLink.test.stories.tsx"],"sourcesContent":["import { Meta, StoryFn, StoryObj } from '@storybook/react-vite';\nimport { expect, fireEvent, userEvent, within } from 'storybook/test';\n\nimport { dsI18n } from '@skatteetaten/ds-core-utils';\n\n// eslint-disable-next-line @nx/enforce-module-boundaries\nimport { TopBannerSkipLink } from '../../../../../libs/ds-layout/src/TopBannerSkipLink/TopBannerSkipLink';\n// eslint-disable-next-line @nx/enforce-module-boundaries\nimport { TopBannerSkipLinkProps } from '../../../../../libs/ds-layout/src/TopBannerSkipLink/TopBannerSkipLink.types';\nimport { webComponent } from '../../../.storybook/webcomponent-decorator';\n\nconst meta = {\n  component: TopBannerSkipLink,\n  title: 'Tester/TopBannerSkipLink (intern)',\n  argTypes: {\n    // Baseprops\n    ref: { table: { disable: true } },\n    className: { table: { disable: true } },\n    id: { table: { disable: true } },\n    lang: { table: { disable: true } },\n    'data-testid': { table: { disable: true } },\n    // Props\n    children: { table: { disable: true } },\n    shadowRootNode: { table: { disable: true } },\n    target: { table: { disable: true } },\n  },\n  tags: ['test'],\n  parameters: {\n    imageSnapshot: { disableSnapshot: false },\n  },\n} satisfies Meta<typeof TopBannerSkipLink>;\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nconst skipLinkText = 'ds_layout:topbanner.SkipLinkText';\nconst defaultArgs: TopBannerSkipLinkProps = {};\n\nexport const WithRef = {\n  name: 'With Ref (FA1)',\n  args: {\n    ref: (instance: HTMLAnchorElement | null): void => {\n      if (instance) {\n        instance.id = 'dummyIdForwardedFromRef';\n      }\n    },\n  },\n  argTypes: {\n    ref: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: { disableSnapshot: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const skipLink = canvas.getByRole('link');\n    await expect(skipLink).toHaveAttribute('id', 'dummyIdForwardedFromRef');\n  },\n} satisfies Story;\n\nexport const WithAttributes = {\n  name: 'With Attributes (FA2-5)',\n  args: {\n    id: 'htmlId',\n    className: 'dummyClassname',\n    lang: 'nb',\n    'data-testid': '123ID',\n  },\n  argTypes: {\n    id: { table: { disable: false } },\n    className: { table: { disable: false } },\n    lang: { table: { disable: false } },\n    'data-testid': { table: { disable: false } },\n  },\n  parameters: {\n    a11y: {\n      test: 'off',\n    },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const skipLink = canvas.getByRole('link');\n    await expect(skipLink).toHaveAttribute('id', 'htmlId');\n    await expect(skipLink).toHaveClass('dummyClassname');\n    await expect(skipLink).toHaveAttribute('lang', 'nb');\n    await expect(skipLink).toHaveAttribute('data-testid', '123ID');\n    skipLink.focus();\n  },\n} satisfies Story;\n\nexport const Defaults = {\n  name: 'Defaults (B2)',\n  args: {\n    ...defaultArgs,\n  },\n  parameters: {\n    imageSnapshot: { pseudoStates: ['focus-visible'] },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const skipLink = canvas.getByRole('link', {\n      name: dsI18n.t(skipLinkText),\n    });\n    expect(skipLink).toBeInTheDocument();\n    expect(skipLink.tagName).toBe('A');\n  },\n} satisfies Story;\n\nconst mainId = 'hovedinnhold';\nconst MainTemplate: StoryFn<typeof TopBannerSkipLink> = (args) => (\n  <>\n    <TopBannerSkipLink {...args} />\n    <main id={mainId}>{'Hovedinnholdet på siden'}</main>\n  </>\n);\n\nexport const WithTargetAndChildren = {\n  render: MainTemplate,\n  name: 'With Target And Children (A3 delvis)',\n  args: {\n    ...defaultArgs,\n    target: `#${mainId}`,\n    children: 'Snarvei til hovedinnhold',\n  },\n  argTypes: {\n    target: { table: { disable: false } },\n    children: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: { disableSnapshot: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const skipLink = canvas.getByRole('link', {\n      name: 'Snarvei til hovedinnhold',\n    });\n    await expect(skipLink).toBeInTheDocument();\n    await expect(skipLink).toHaveAttribute('href', `#${mainId}`);\n    await fireEvent.click(skipLink);\n    const main = canvas.getByRole('main');\n    await expect(main).toHaveFocus();\n  },\n} satisfies Story;\n\nexport const ClickSkipLink = {\n  render: MainTemplate,\n  name: 'Click SkipLink (A3, C1 delvis)',\n  args: {\n    ...defaultArgs,\n  },\n  argTypes: {},\n  parameters: {\n    imageSnapshot: { disableSnapshot: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const main = canvas.getByRole('main');\n    const skipLink = canvas.getByRole('link', {\n      name: dsI18n.t(skipLinkText),\n    });\n    skipLink.focus();\n    await fireEvent.click(skipLink);\n    await expect(main).toHaveFocus();\n  },\n} satisfies Story;\n\nconst TemplateWithShadowDom: StoryFn<typeof TopBannerSkipLink> = (args) => {\n  const element = document.querySelector('skiplink-customelement');\n  const shadowRoot = element?.shadowRoot;\n  return (\n    <div>\n      <TopBannerSkipLink {...args} shadowRootNode={shadowRoot ?? undefined} />\n      <main>{'Hovedinnholdet på siden'}</main>\n    </div>\n  );\n};\n\nexport const WithShadowDom = {\n  render: TemplateWithShadowDom,\n  name: 'With ShadowDom',\n  args: {\n    ...defaultArgs,\n  },\n  decorators: [webComponent],\n  parameters: {\n    imageSnapshot: {\n      disable: true,\n    },\n    customElementName: 'skiplink-customelement',\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    //skipLink finnes ikke utenfor shadowDom\n    await expect(canvas.queryByRole('link')).not.toBeInTheDocument();\n\n    const customElement = canvasElement.querySelector(`skiplink-customelement`);\n    await expect(customElement).toBeInTheDocument();\n    const skipLink =\n      customElement?.shadowRoot && customElement.shadowRoot.querySelector('a');\n\n    await expect(skipLink).toBeInTheDocument();\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    await userEvent.click(skipLink!);\n\n    const main =\n      customElement?.shadowRoot &&\n      customElement.shadowRoot.querySelector('main:focus');\n    await expect(main).toBeInTheDocument();\n  },\n} satisfies Story;\n"],"names":["expect","fireEvent","userEvent","within","meta","component","TopBannerSkipLink","title","argTypes","ref","table","disable","className","id","lang","children","shadowRootNode","target","tags","parameters","imageSnapshot","disableSnapshot","skipLinkText","defaultArgs","WithRef","name","args","instance","play","canvasElement","skipLink","getByRole","toHaveAttribute","WithAttributes","a11y","test","toHaveClass","focus","Defaults","pseudoStates","dsI18n","t","toBeInTheDocument","tagName","toBe","mainId","MainTemplate","jsxs","Fragment","jsx","WithTargetAndChildren","render","canvas","click","main","toHaveFocus","ClickSkipLink","TemplateWithShadowDom","shadowRoot","document","querySelector","undefined","WithShadowDom","decorators","webComponent","customElementName","queryByRole","not","customElement","docs","source","originalSource"],"mappings":"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"}