{"version":3,"file":"Popover.test.stories-BJb4WOcI.js","sources":["../../../../libs/ds-overlays/src/Popover/Popover.types.ts","../../../../apps/ds-playground/src/stories/__tests__/Popover.test.stories.tsx"],"sourcesContent":["import {\n  Dispatch,\n  FunctionComponent,\n  MutableRefObject,\n  ReactNode,\n  SetStateAction,\n} from 'react';\n\nimport { UseFloatingReturn, useInteractions } from '@floating-ui/react';\n\nimport { colorNamesArr, positionArr } from '@skatteetaten/ds-core-utils';\n\nimport { PopoverContent } from '../PopoverContent/PopoverContent';\nimport { PopoverTrigger } from '../PopoverTrigger/PopoverTrigger';\n\nexport type PopoverPosition = Extract<\n  (typeof positionArr)[number],\n  'topStart' | 'topEnd' | 'bottomStart' | 'bottomEnd'\n>;\n\nexport type PopoverColor = Extract<\n  (typeof colorNamesArr)[number],\n  'ochre' | 'forest' | 'white'\n>;\n\nexport const popoverColorArr: PopoverColor[] = [\n  colorNamesArr[0],\n  colorNamesArr[1],\n  colorNamesArr[6],\n];\n\nexport interface PopoverProps {\n  /** Plassering av popover */\n  position?: PopoverPosition;\n  /** Bakgrunnsfarge */\n  color?: PopoverColor;\n  /** Om autolukking skal skrus av */\n  disableAutoDismiss?: boolean;\n  /** Om autolukking skal skrus av på enheter med smal skjerm.  Gjelder også selv om disableAutoDismiss er satt til false. */\n  disableAutoDismissOnMobile?: boolean;\n  /** Om Popover er synlig */\n  isOpen?: boolean;\n  /** Om focus skal settes tilbake til trigger ved bruk av lukkekrysset. */\n  shouldRestoreFocus?: boolean;\n  /** Callback når Popover lukkes */\n  onClose?: () => void;\n  /** Popover.Content og Popover.Trigger */\n  children?: ReactNode;\n}\n\nexport interface PopoverComponent extends FunctionComponent<PopoverProps> {\n  Content: typeof PopoverContent;\n  Trigger: typeof PopoverTrigger;\n}\n\nexport interface PopoverContextProps extends Exclude<PopoverProps, 'children'> {\n  arrowRef: MutableRefObject<HTMLDivElement | null>;\n  floatingData: UseFloatingReturn<HTMLButtonElement>;\n  interactions: ReturnType<typeof useInteractions>;\n  isOpen: boolean;\n  setIsOpen: Dispatch<SetStateAction<boolean>>;\n  isMobile: boolean;\n}\n","import { StoryFn, Meta, StoryObj } from '@storybook/react';\nimport { expect, fireEvent, fn, userEvent, within } from '@storybook/test';\n\nimport { dsI18n } from '@skatteetaten/ds-core-utils';\nimport { Popover, popoverColorArr } from '@skatteetaten/ds-overlays';\n\nimport { loremIpsum } from './testUtils/storybook.testing.utils';\n\nconst defaultText =\n  'Avvist av kortutsteder. Ta kontakt med kortutsteder for mer informasjon.';\nconst Template: StoryFn<typeof Popover> = (args) => (\n  <Popover {...args}>\n    <Popover.Trigger />\n    <Popover.Content>{defaultText}</Popover.Content>\n  </Popover>\n);\n\nconst meta = {\n  component: Popover,\n  title: 'Tester/Popover/Popover',\n  argTypes: {\n    // Baseprops\n    // @ts-expect-error disable baseprops gir error fordi denne komponenten ikke støtter baseprops, men de skal disables alikevel\n    ref: { table: { disable: true } },\n    className: { table: { disable: true } },\n    id: { table: { disable: true } },\n    lang: { table: { disable: true } },\n    'data-testid': { table: { disable: true } },\n    // Props\n    children: {\n      table: { disable: true },\n      control: 'text',\n    },\n    color: {\n      options: [...popoverColorArr],\n      control: 'radio',\n      table: { disable: true },\n    },\n    disableAutoDismiss: { table: { disable: true } },\n    disableAutoDismissOnMobile: { table: { disable: true } },\n    isOpen: { table: { disable: true } },\n    position: { table: { disable: true } },\n    shouldRestoreFocus: {\n      table: { disable: true },\n    },\n    // Event\n    onClose: { table: { disable: true } },\n  },\n  render: Template,\n} satisfies Meta<typeof Popover>;\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nexport const Defaults = {\n  name: 'Defaults',\n  args: {},\n  argTypes: {\n    children: { table: { disable: false } },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const triggerButton = canvas.getByRole('button');\n    await expect(triggerButton).toBeInTheDocument();\n  },\n} satisfies Story;\n\nconst TemplateAllColors: StoryFn<typeof Popover> = (args) => (\n  <div className={'flex gapS centerContent'}>\n    <Popover color={'forest'} position={'topEnd'} isOpen {...args}>\n      <Popover.Trigger size={'extraSmall'} />\n      <Popover.Content>{args.children}</Popover.Content>\n    </Popover>\n    <Popover color={'white'} position={'bottomEnd'} isOpen {...args}>\n      <Popover.Trigger size={'small'} />\n      <Popover.Content>{args.children}</Popover.Content>\n    </Popover>\n    <Popover color={'ochre'} position={'topStart'} isOpen {...args}>\n      <Popover.Trigger size={'medium'} />\n      <Popover.Content>{args.children}</Popover.Content>\n    </Popover>\n    <Popover color={'forest'} position={'bottomStart'} isOpen {...args}>\n      <Popover.Trigger size={'large'} />\n      <Popover.Content>{args.children}</Popover.Content>\n    </Popover>\n  </div>\n);\n\nexport const AllColors = {\n  render: TemplateAllColors,\n  name: 'All Colors Floating Position (A1, A2, A3, A4)',\n  argTypes: {\n    position: { table: { disable: false } },\n    color: { table: { disable: false } },\n  },\n  args: {\n    children: loremIpsum,\n  },\n} satisfies Story;\n\nexport const WithOnClickTriggerAndCloseButton = {\n  name: 'With OnClick Trigger Close Button (A9)',\n  args: {\n    onClose: fn(),\n  },\n\n  parameters: {\n    imageSnapshot: { disable: true },\n    HTMLSnapshot: { disable: true },\n  },\n  play: async ({ canvasElement, args }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toBeInTheDocument();\n    await expect(button).toHaveAttribute('aria-expanded', 'false');\n    await expect(canvas.queryByText(defaultText)).not.toBeInTheDocument();\n    await fireEvent.click(button);\n    await expect(button).toHaveAttribute('aria-expanded', 'true');\n    await expect(canvas.getByText(defaultText)).toBeInTheDocument();\n    await fireEvent.click(button);\n    await expect(canvas.queryByText(defaultText)).not.toBeInTheDocument();\n    await fireEvent.click(button);\n    const closeButton = canvas.getByTitle(dsI18n.t('Shared:shared.Close'));\n    await fireEvent.click(closeButton);\n    await expect(canvas.queryByText(defaultText)).not.toBeInTheDocument();\n    await expect(args.onClose).toHaveBeenCalled();\n  },\n} satisfies Story;\n\nexport const WithAutoClose = {\n  name: 'With AutoClose (A8)',\n  args: {},\n  argTypes: {\n    disableAutoDismiss: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n    HTMLSnapshot: { disable: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toBeInTheDocument();\n    await expect(canvas.queryByText(defaultText)).not.toBeInTheDocument();\n    await fireEvent.click(button);\n    await expect(canvas.getByText(defaultText)).toBeInTheDocument();\n    await userEvent.click(document.body);\n    await expect(canvas.queryByText(defaultText)).not.toBeInTheDocument();\n  },\n} satisfies Story;\n\nexport const WithAutoCloseDisabled = {\n  name: 'With AutoClose Disabled (A8)',\n  argTypes: {\n    disableAutoDismiss: { table: { disable: false } },\n  },\n  args: {\n    disableAutoDismiss: true,\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n    HTMLSnapshot: { disable: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toBeInTheDocument();\n    await expect(canvas.queryByText(defaultText)).not.toBeInTheDocument();\n    await fireEvent.click(button);\n    await expect(canvas.getByText(defaultText)).toBeInTheDocument();\n    await userEvent.click(document.body);\n    await expect(canvas.getByText(defaultText)).toBeInTheDocument();\n  },\n} satisfies Story;\n"],"names":["popoverColorArr","colorNamesArr","defaultText","Template","args","jsxs","Popover","jsx","meta","component","title","argTypes","ref","table","disable","className","id","lang","children","control","color","options","disableAutoDismiss","disableAutoDismissOnMobile","isOpen","position","shouldRestoreFocus","onClose","render","Defaults","name","play","canvasElement","triggerButton","within","getByRole","expect","toBeInTheDocument","TemplateAllColors","AllColors","loremIpsum","WithOnClickTriggerAndCloseButton","fn","parameters","imageSnapshot","HTMLSnapshot","canvas","button","toHaveAttribute","queryByText","not","fireEvent","click","getByText","closeButton","getByTitle","dsI18n","t","toHaveBeenCalled","WithAutoClose","userEvent","document","body","WithAutoCloseDisabled","docs","source","originalSource"],"mappings":"8vBAyBO,MAAMA,EAAkC,CAC7CC,EAAc,CAAC,EACfA,EAAc,CAAC,EACfA,EAAc,CAAC,CACjB,ECrBMC,EACJ,2EACIC,EAAqCC,GACxCC,EAAA,KAAAC,EAAA,CAAQ,GAAIF,EACX,SAAA,CAACG,MAAAD,EAAQ,QAAR,EAAe,EACfC,EAAAA,IAAAD,EAAQ,QAAR,CAAiBJ,SAAYA,CAAA,CAAA,CAAA,EAChC,EAGIM,GAAO,CACXC,UAAWH,EACXI,MAAO,yBACPC,SAAU,CAGRC,IAAK,CAAEC,MAAO,CAAEC,QAAS,EAAA,CAAO,EAChCC,UAAW,CAAEF,MAAO,CAAEC,QAAS,EAAA,CAAO,EACtCE,GAAI,CAAEH,MAAO,CAAEC,QAAS,EAAA,CAAO,EAC/BG,KAAM,CAAEJ,MAAO,CAAEC,QAAS,EAAA,CAAO,EACjC,cAAe,CAAED,MAAO,CAAEC,QAAS,EAAA,CAAO,EAE1CI,SAAU,CACRL,MAAO,CAAEC,QAAS,EAAK,EACvBK,QAAS,MACX,EACAC,MAAO,CACLC,QAAS,CAAC,GAAGrB,CAAe,EAC5BmB,QAAS,QACTN,MAAO,CAAEC,QAAS,EAAA,CACpB,EACAQ,mBAAoB,CAAET,MAAO,CAAEC,QAAS,EAAA,CAAO,EAC/CS,2BAA4B,CAAEV,MAAO,CAAEC,QAAS,EAAA,CAAO,EACvDU,OAAQ,CAAEX,MAAO,CAAEC,QAAS,EAAA,CAAO,EACnCW,SAAU,CAAEZ,MAAO,CAAEC,QAAS,EAAA,CAAO,EACrCY,mBAAoB,CAClBb,MAAO,CAAEC,QAAS,EAAA,CACpB,EAEAa,QAAS,CAAEd,MAAO,CAAEC,QAAS,EAAA,CAAK,CACpC,EACAc,OAAQzB,CACV,EAIa0B,EAAW,CACtBC,KAAM,WACN1B,KAAM,CAAC,EACPO,SAAU,CACRO,SAAU,CAAEL,MAAO,CAAEC,QAAS,EAAA,CAAM,CACtC,EACAiB,KAAM,MAAO,CAAEC,cAAAA,CAAAA,IAAmC,CAE1CC,MAAAA,EADSC,EAAOF,CAAa,EACNG,UAAU,QAAQ,EACzCC,MAAAA,EAAOH,CAAa,EAAEI,kBAAkB,CAAA,CAElD,EAEMC,EAA8ClC,GACjDC,EAAA,KAAA,MAAA,CAAI,UAAW,0BACd,SAAA,CAACA,EAAAA,KAAAC,EAAA,CAAQ,MAAO,SAAU,SAAU,SAAU,OAAM,GAAC,GAAIF,EACvD,SAAA,CAAAG,EAAAA,IAACD,EAAQ,QAAR,CAAgB,KAAM,YAAa,CAAA,EACnCC,EAAA,IAAAD,EAAQ,QAAR,CAAiBF,WAAKc,QAAS,CAAA,CAAA,EAClC,EACAb,EAAAA,KAACC,GAAQ,MAAO,QAAS,SAAU,YAAa,OAAM,GAAC,GAAIF,EACzD,SAAA,CAAAG,EAAAA,IAACD,EAAQ,QAAR,CAAgB,KAAM,OAAQ,CAAA,EAC9BC,EAAA,IAAAD,EAAQ,QAAR,CAAiBF,WAAKc,QAAS,CAAA,CAAA,EAClC,EACAb,EAAAA,KAACC,GAAQ,MAAO,QAAS,SAAU,WAAY,OAAM,GAAC,GAAIF,EACxD,SAAA,CAAAG,EAAAA,IAACD,EAAQ,QAAR,CAAgB,KAAM,QAAS,CAAA,EAC/BC,EAAA,IAAAD,EAAQ,QAAR,CAAiBF,WAAKc,QAAS,CAAA,CAAA,EAClC,EACAb,EAAAA,KAACC,GAAQ,MAAO,SAAU,SAAU,cAAe,OAAM,GAAC,GAAIF,EAC5D,SAAA,CAAAG,EAAAA,IAACD,EAAQ,QAAR,CAAgB,KAAM,OAAQ,CAAA,EAC9BC,EAAA,IAAAD,EAAQ,QAAR,CAAiBF,WAAKc,QAAS,CAAA,CAAA,CAClC,CAAA,CAAA,EACF,EAGWqB,EAAY,CACvBX,OAAQU,EACRR,KAAM,gDACNnB,SAAU,CACRc,SAAU,CAAEZ,MAAO,CAAEC,QAAS,EAAA,CAAQ,EACtCM,MAAO,CAAEP,MAAO,CAAEC,QAAS,EAAA,CAAM,CACnC,EACAV,KAAM,CACJc,SAAUsB,CAAAA,CAEd,EAEaC,EAAmC,CAC9CX,KAAM,yCACN1B,KAAM,CACJuB,QAASe,EAAG,CACd,EAEAC,WAAY,CACVC,cAAe,CAAE9B,QAAS,EAAK,EAC/B+B,aAAc,CAAE/B,QAAS,EAAA,CAC3B,EACAiB,KAAM,MAAO,CAAEC,cAAAA,EAAe5B,KAAAA,CAAAA,IAA0B,CAChD0C,MAAAA,EAASZ,EAAOF,CAAa,EAC7Be,EAASD,EAAOX,UAAU,QAAQ,EAClCC,MAAAA,EAAOW,CAAM,EAAEV,kBAAkB,EACvC,MAAMD,EAAOW,CAAM,EAAEC,gBAAgB,gBAAiB,OAAO,EAC7D,MAAMZ,EAAOU,EAAOG,YAAY/C,CAAW,CAAC,EAAEgD,IAAIb,kBAAkB,EAC9Dc,MAAAA,EAAUC,MAAML,CAAM,EAC5B,MAAMX,EAAOW,CAAM,EAAEC,gBAAgB,gBAAiB,MAAM,EAC5D,MAAMZ,EAAOU,EAAOO,UAAUnD,CAAW,CAAC,EAAEmC,kBAAkB,EACxDc,MAAAA,EAAUC,MAAML,CAAM,EAC5B,MAAMX,EAAOU,EAAOG,YAAY/C,CAAW,CAAC,EAAEgD,IAAIb,kBAAkB,EAC9Dc,MAAAA,EAAUC,MAAML,CAAM,EAC5B,MAAMO,EAAcR,EAAOS,WAAWC,EAAOC,EAAE,qBAAqB,CAAC,EAC/DN,MAAAA,EAAUC,MAAME,CAAW,EACjC,MAAMlB,EAAOU,EAAOG,YAAY/C,CAAW,CAAC,EAAEgD,IAAIb,kBAAkB,EACpE,MAAMD,EAAOhC,EAAKuB,OAAO,EAAE+B,iBAAiB,CAAA,CAEhD,EAEaC,EAAgB,CAC3B7B,KAAM,sBACN1B,KAAM,CAAC,EACPO,SAAU,CACRW,mBAAoB,CAAET,MAAO,CAAEC,QAAS,EAAA,CAAM,CAChD,EACA6B,WAAY,CACVC,cAAe,CAAE9B,QAAS,EAAK,EAC/B+B,aAAc,CAAE/B,QAAS,EAAA,CAC3B,EACAiB,KAAM,MAAO,CAAEC,cAAAA,CAAAA,IAAmC,CAC1Cc,MAAAA,EAASZ,EAAOF,CAAa,EAC7Be,EAASD,EAAOX,UAAU,QAAQ,EAClCC,MAAAA,EAAOW,CAAM,EAAEV,kBAAkB,EACvC,MAAMD,EAAOU,EAAOG,YAAY/C,CAAW,CAAC,EAAEgD,IAAIb,kBAAkB,EAC9Dc,MAAAA,EAAUC,MAAML,CAAM,EAC5B,MAAMX,EAAOU,EAAOO,UAAUnD,CAAW,CAAC,EAAEmC,kBAAkB,EACxDuB,MAAAA,EAAUR,MAAMS,SAASC,IAAI,EACnC,MAAM1B,EAAOU,EAAOG,YAAY/C,CAAW,CAAC,EAAEgD,IAAIb,kBAAkB,CAAA,CAExE,EAEa0B,EAAwB,CACnCjC,KAAM,+BACNnB,SAAU,CACRW,mBAAoB,CAAET,MAAO,CAAEC,QAAS,EAAA,CAAM,CAChD,EACAV,KAAM,CACJkB,mBAAoB,EACtB,EACAqB,WAAY,CACVC,cAAe,CAAE9B,QAAS,EAAK,EAC/B+B,aAAc,CAAE/B,QAAS,EAAA,CAC3B,EACAiB,KAAM,MAAO,CAAEC,cAAAA,CAAAA,IAAmC,CAC1Cc,MAAAA,EAASZ,EAAOF,CAAa,EAC7Be,EAASD,EAAOX,UAAU,QAAQ,EAClCC,MAAAA,EAAOW,CAAM,EAAEV,kBAAkB,EACvC,MAAMD,EAAOU,EAAOG,YAAY/C,CAAW,CAAC,EAAEgD,IAAIb,kBAAkB,EAC9Dc,MAAAA,EAAUC,MAAML,CAAM,EAC5B,MAAMX,EAAOU,EAAOO,UAAUnD,CAAW,CAAC,EAAEmC,kBAAkB,EACxDuB,MAAAA,EAAUR,MAAMS,SAASC,IAAI,EACnC,MAAM1B,EAAOU,EAAOO,UAAUnD,CAAW,CAAC,EAAEmC,kBAAkB,CAAA,CAElE,YAAiBR,EAAAc,WAAA,CAAA,GAAAd,EAAAc,WAAAqB,KAAA,CAAA,IAAAnC,EAAAA,EAAAc,aAAAd,YAAAA,EAAAmC,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,IAAArC,GAAAA,EAAAA,EAAAc,aAAAd,YAAAA,EAAAmC,OAAAnC,YAAAA,EAAAoC,MAAAA,CAAA,CAAA,YAAA1B,EAAAI,WAAA,CAAA,GAAAJ,EAAAI,WAAAqB,KAAA,CAAA,IAAAzB,EAAAA,EAAAI,aAAAJ,YAAAA,EAAAyB,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,IAAA3B,GAAAA,EAAAA,EAAAI,aAAAJ,YAAAA,EAAAyB,OAAAzB,YAAAA,EAAA0B,MAAAA,CAAA,CAAA,YAAAxB,EAAAE,WAAA,CAAA,GAAAF,EAAAE,WAAAqB,KAAA,CAAA,IAAAvB,EAAAA,EAAAE,aAAAF,YAAAA,EAAAuB,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,IAAAzB,GAAAA,EAAAA,EAAAE,aAAAF,YAAAA,EAAAuB,OAAAvB,YAAAA,EAAAwB,MAAAA,CAAA,CAAA,YAAAN,EAAAhB,WAAA,CAAA,GAAAgB,EAAAhB,WAAAqB,KAAA,CAAA,IAAAL,EAAAA,EAAAhB,aAAAgB,YAAAA,EAAAK,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,IAAAP,GAAAA,EAAAA,EAAAhB,aAAAgB,YAAAA,EAAAK,OAAAL,YAAAA,EAAAM,MAAAA,CAAA,CAAA,YAAAF,EAAApB,WAAA,CAAA,GAAAoB,EAAApB,WAAAqB,KAAA,CAAA,IAAAD,EAAAA,EAAApB,aAAAoB,YAAAA,EAAAC,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,IAAAH,GAAAA,EAAAA,EAAApB,aAAAoB,YAAAA,EAAAC,OAAAD,YAAAA,EAAAE,MAAAA,CAAA,CAAA"}