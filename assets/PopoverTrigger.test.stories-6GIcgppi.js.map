{"version":3,"file":"PopoverTrigger.test.stories-6GIcgppi.js","sources":["../../../../apps/ds-playground/src/stories/__tests__/PopoverTrigger.test.stories.tsx"],"sourcesContent":["import { JSX } from 'react';\n\nimport { Meta, StoryObj } from '@storybook/react-vite';\nimport { expect, fn, userEvent, waitFor, within } from 'storybook/test';\n\nimport { Popover } from '@skatteetaten/ds-overlays';\n\nimport { category, htmlEventDescription } from '../../../.storybook/helpers';\nimport { SystemSVGPaths } from '../utils/icon.systems';\n\nconst verifyAttribute =\n  (attribute: string, expectedValue: string) =>\n  async ({ canvasElement }: { canvasElement: HTMLElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const iconButton = canvas.getByRole('button');\n    await expect(iconButton).toBeInTheDocument();\n    await expect(iconButton).toHaveAttribute(attribute, expectedValue);\n  };\n\nconst meta = {\n  component: Popover.Trigger,\n  title: 'Tester/Popover/Trigger',\n  argTypes: {\n    // Baseprops\n    ref: { table: { disable: true } },\n    className: { table: { disable: true } },\n    id: { table: { disable: true } },\n    lang: { table: { disable: true } },\n    'data-testid': { table: { disable: true } },\n    // Props\n    size: { table: { disable: true } },\n    svgPath: {\n      options: Object.keys(SystemSVGPaths),\n      mapping: SystemSVGPaths,\n      table: { disable: true },\n    },\n    //HTML\n    title: { table: { category: category.htmlAttribute, disable: true } },\n    // Aria\n    ariaDescribedby: { table: { category: category.aria, disable: true } },\n    //Events\n    onFocus: { ...htmlEventDescription, table: { disable: true } },\n    onClick: { ...htmlEventDescription, table: { disable: true } },\n    onBlur: { ...htmlEventDescription, table: { disable: true } },\n  },\n  render: (args): JSX.Element => (\n    <Popover>\n      <Popover.Trigger {...args} />\n    </Popover>\n  ),\n  tags: ['test'],\n  parameters: {\n    imageSnapshot: { disableSnapshot: false },\n  },\n} satisfies Meta<typeof Popover.Trigger>;\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nexport const WithRef = {\n  name: 'With Ref (FA1)',\n  args: {\n    ref: (instance: HTMLButtonElement | null): void => {\n      if (instance) {\n        instance.id = 'dummyIdForwardedFromRef';\n      }\n    },\n  },\n  argTypes: {\n    ref: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: { disableSnapshot: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toHaveAttribute('id', 'dummyIdForwardedFromRef');\n  },\n} satisfies Story;\n\nexport const WithAttributes = {\n  name: 'With Attributes (FA2-5)',\n  args: {\n    id: 'htmlId',\n    className: 'dummyClassname',\n    lang: 'en',\n    'data-testid': '123ID',\n  },\n  argTypes: {\n    id: { table: { disable: false } },\n    className: { table: { disable: false } },\n    lang: { table: { disable: false } },\n    'data-testid': { table: { disable: false } },\n  },\n  parameters: {\n    a11y: {\n      test: 'off',\n    },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toHaveAttribute('id', 'htmlId');\n    await expect(button).toHaveClass('dummyClassname');\n    await expect(button).toHaveAttribute('lang', 'en');\n    await expect(button).toHaveAttribute('data-testid', '123ID');\n  },\n} satisfies Story;\n\nexport const WithAriaDescribedby = {\n  name: 'With AriaDescribedby',\n  args: {\n    ariaDescribedby: 'araiDescId',\n  },\n  argTypes: {\n    ariaDescribedby: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: {\n      disable: true,\n    },\n  },\n  play: verifyAttribute('aria-describedby', 'araiDescId'),\n} satisfies Story;\n\nexport const WithEventHandlers = {\n  name: 'With EventHandlers',\n  args: {\n    onFocus: fn(),\n    onBlur: fn(),\n    onClick: fn(),\n  },\n  parameters: {\n    imageSnapshot: { disableSnapshot: true },\n  },\n  play: async ({ args, canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const iconButton = canvas.getByRole('button');\n    await expect(iconButton).toBeInTheDocument();\n    iconButton.focus();\n    await waitFor(() => expect(args.onFocus).toHaveBeenCalled());\n    await userEvent.tab();\n    await waitFor(() => expect(args.onBlur).toHaveBeenCalled());\n    await userEvent.click(iconButton);\n    await waitFor(() => expect(args.onClick).toHaveBeenCalled());\n  },\n} satisfies Story;\n"],"names":["expect","fn","userEvent","waitFor","within","verifyAttribute","attribute","expectedValue","canvasElement","iconButton","getByRole","toBeInTheDocument","toHaveAttribute","meta","component","Popover","Trigger","title","argTypes","ref","table","disable","className","id","lang","size","svgPath","options","Object","keys","SystemSVGPaths","mapping","category","htmlAttribute","ariaDescribedby","aria","onFocus","htmlEventDescription","onClick","onBlur","render","args","jsx","tags","parameters","imageSnapshot","disableSnapshot","WithRef","name","instance","play","button","WithAttributes","a11y","test","toHaveClass","WithAriaDescribedby","WithEventHandlers","focus","toHaveBeenCalled","tab","click","docs","source","originalSource"],"mappings":"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"}