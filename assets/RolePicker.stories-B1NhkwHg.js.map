{"version":3,"file":"RolePicker.stories-B1NhkwHg.js","sources":["../../../../apps/ds-playground/src/stories/components/RolePicker.stories.tsx"],"sourcesContent":["import { JSX, useRef, useState, MouseEvent } from 'react';\n\nimport { Meta, StoryObj } from '@storybook/react';\n\nimport { Button } from '@skatteetaten/ds-buttons';\nimport { dsI18n, langToLocale } from '@skatteetaten/ds-core-utils';\nimport { User, TopBannerExternal } from '@skatteetaten/ds-layout';\nimport {\n  Business,\n  Entity,\n  Person,\n  RolePicker,\n  getModalDismissOnEscDefault,\n  getModalDismissOnOutsideClickDefault,\n  getRolePickerHideCloseButtonDefault,\n  Paginated,\n  OnEntitySelectHandler,\n  getRolePickerShowInactiveBusinessesDefault,\n  getRolePickerShowSubunitsDefault,\n} from '@skatteetaten/ds-overlays';\n\nimport { category } from '../../../.storybook/helpers';\nimport { exampleParameters } from '../utils/stories.utils';\n\nconst me: Person = {\n  name: 'Ola Nordmann',\n  personId: '101010 12345',\n  type: 'Person',\n};\n\nconst businesses: Paginated<Business> = {\n  total: 12,\n  list: [\n    {\n      name: 'Costco',\n      organizationNumber: '123456777',\n      isDeleted: false,\n      unitType: 'AS',\n      type: 'Organization',\n      subunits: [\n        {\n          name: 'Google',\n          organizationNumber: '123456789',\n          isDeleted: false,\n          type: 'Organization',\n          unitType: 'AS',\n        },\n        {\n          name: 'Facebook',\n          organizationNumber: '123456790',\n          isDeleted: true,\n          type: 'Organization',\n          unitType: 'AS',\n        },\n      ],\n    },\n    {\n      name: 'Instagram',\n      organizationNumber: '312843211',\n      isDeleted: true,\n      unitType: 'AS',\n      type: 'Organization',\n      subunits: [\n        {\n          name: 'Snapchat',\n          organizationNumber: '123456623',\n          isDeleted: true,\n          type: 'Organization',\n          unitType: 'AS',\n        },\n        {\n          name: 'Statoil',\n          organizationNumber: '312849218',\n          isDeleted: false,\n          type: 'Organization',\n          unitType: 'AS',\n        },\n      ],\n    },\n    {\n      name: 'Samsung',\n      organizationNumber: '312943218',\n      isDeleted: false,\n      type: 'Organization',\n      unitType: 'AS',\n    },\n\n    {\n      name: 'Toshiba',\n      organizationNumber: '312643218',\n      isDeleted: false,\n      type: 'Organization',\n      unitType: 'AS',\n    },\n\n    {\n      name: 'Hitachi',\n      organizationNumber: '312743218',\n      isDeleted: false,\n      type: 'Organization',\n      unitType: 'AS',\n    },\n\n    {\n      name: 'Vanguard',\n      organizationNumber: '332843218',\n      isDeleted: false,\n      type: 'Organization',\n      unitType: 'AS',\n    },\n\n    {\n      name: 'Amazon',\n      organizationNumber: '112843218',\n      isDeleted: false,\n      type: 'Organization',\n      unitType: 'AS',\n    },\n    {\n      name: 'Meta',\n      organizationNumber: '212843218',\n      isDeleted: false,\n      type: 'Organization',\n      unitType: 'AS',\n    },\n  ],\n};\n\nconst people: Paginated<Person> = {\n  total: 4,\n  list: [\n    {\n      name: 'Antikvitet presis',\n      personId: '138899 99726',\n      type: 'Person',\n      isDeleted: false,\n    },\n    {\n      name: 'Bønne elegant',\n      personId: '188495 74503',\n      type: 'Person',\n      isDeleted: false,\n    },\n    {\n      name: 'Lomme filosofisk',\n      personId: '088896 74513',\n      type: 'Person',\n      isDeleted: false,\n    },\n    {\n      name: 'Adelsmann varm',\n      personId: '148924 49911',\n      type: 'Person',\n      isDeleted: false,\n    },\n  ],\n};\n\nconst meta = {\n  component: RolePicker,\n  title: 'Komponenter/RolePicker',\n  render: (_args): JSX.Element => {\n    const [user, setUser] = useState<User>();\n    const rolePickerRef = useRef<HTMLDialogElement>(null);\n\n    const handleEntitySelect: OnEntitySelectHandler = async (\n      entity: Entity\n    ) => {\n      let role: User['role'];\n      if (entity.name === me.name) {\n        role = 'meg';\n      } else if (entity.type === 'Organization') {\n        role = 'virksomhet';\n      } else {\n        role = 'andre';\n      }\n\n      setUser({\n        role: role,\n        name: entity.name,\n      });\n\n      rolePickerRef.current?.close();\n    };\n\n    return (\n      <>\n        <Button onClick={() => rolePickerRef.current?.showModal()}>\n          {!user\n            ? 'Åpne representasjonsvelger'\n            : user?.role === 'meg'\n              ? 'Meg selv'\n              : user?.name}\n        </Button>\n        <RolePicker\n          ref={rolePickerRef}\n          me={me}\n          businesses={businesses}\n          people={people}\n          {..._args}\n          onEntitySelect={handleEntitySelect}\n        ></RolePicker>\n      </>\n    );\n  },\n  argTypes: {\n    // Props\n    children: { control: false, table: { category: category.props } },\n    me: { control: 'object', table: { category: category.props } },\n    people: { control: 'object', table: { category: category.props } },\n    businesses: { control: 'object', table: { category: category.props } },\n    dismissOnEsc: {\n      table: {\n        category: category.props,\n        defaultValue: { summary: getModalDismissOnEscDefault().toString() },\n      },\n    },\n    dismissOnOutsideClick: {\n      table: {\n        category: category.props,\n        defaultValue: {\n          summary: getModalDismissOnOutsideClickDefault().toString(),\n        },\n      },\n    },\n    hideCloseButton: {\n      table: {\n        category: category.props,\n        defaultValue: {\n          summary: getRolePickerHideCloseButtonDefault().toString(),\n        },\n      },\n    },\n    showInactiveBusinesses: {\n      table: {\n        category: category.props,\n        defaultValue: {\n          summary: getRolePickerShowInactiveBusinessesDefault().toString(),\n        },\n      },\n    },\n    showSubunits: {\n      table: {\n        category: category.props,\n        defaultValue: {\n          summary: getRolePickerShowSubunitsDefault().toString(),\n        },\n      },\n    },\n    title: {\n      table: {\n        category: category.props,\n      },\n    },\n    // Events\n    onClose: { control: false, table: { category: category.event } },\n    onEntitySelect: { control: false, table: { category: category.event } },\n    onLogout: { control: false, table: { category: category.event } },\n  },\n  args: {\n    me,\n    people,\n    businesses,\n  },\n} satisfies Meta<typeof RolePicker>;\n\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nexport const Preview: Story = {} satisfies Story;\n\nexport const WithExternalTopBanner: Story = {\n  render: (_args): JSX.Element => {\n    const modalRef = useRef<HTMLDialogElement>(null);\n    const [user, setUser] = useState<User>();\n\n    const handleLanguageClick = (e: MouseEvent<HTMLButtonElement>): void => {\n      const lang = e.currentTarget.lang;\n      dsI18n.changeLanguage(langToLocale[lang]);\n    };\n\n    const handleLogOut = (): void => {\n      setUser(undefined);\n    };\n\n    const handleLogIn = (): void => {\n      modalRef.current?.showModal();\n    };\n\n    return (\n      <>\n        <TopBannerExternal\n          user={user}\n          onLanguageClick={handleLanguageClick}\n          onLogInClick={handleLogIn}\n          onLogOutClick={handleLogOut}\n          onUserClick={(): void => modalRef.current?.showModal()}\n        />\n        <RolePicker\n          ref={modalRef}\n          me={me}\n          businesses={businesses}\n          people={people}\n          onEntitySelect={async (entity) => {\n            let role: User['role'];\n            if (entity.name === me.name) {\n              role = 'meg';\n            } else if (entity.type === 'Organization') {\n              role = 'virksomhet';\n            } else {\n              role = 'andre';\n            }\n\n            setUser({\n              role: role,\n              name: entity.name,\n            });\n            modalRef.current?.close();\n          }}\n        />\n      </>\n    );\n  },\n} satisfies Story;\n\nWithExternalTopBanner.parameters = exampleParameters;\n"],"names":["me","name","personId","type","businesses","total","list","organizationNumber","isDeleted","unitType","subunits","people","meta","component","RolePicker","title","render","_args","user","setUser","useState","rolePickerRef","useRef","handleEntitySelect","entity","role","current","close","jsxs","Fragment","jsx","Button","showModal","argTypes","children","control","table","category","props","dismissOnEsc","defaultValue","summary","getModalDismissOnEscDefault","toString","dismissOnOutsideClick","getModalDismissOnOutsideClickDefault","hideCloseButton","getRolePickerHideCloseButtonDefault","showInactiveBusinesses","getRolePickerShowInactiveBusinessesDefault","showSubunits","getRolePickerShowSubunitsDefault","onClose","event","onEntitySelect","onLogout","args","Preview","WithExternalTopBanner","modalRef","handleLanguageClick","e","lang","currentTarget","changeLanguage","langToLocale","handleLogOut","undefined","handleLogIn","TopBannerExternal","parameters","exampleParameters","docs","source","originalSource"],"mappings":"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"}