{"version":3,"file":"TopBannerInternalActionMenu.test.stories-BwKijiE7.js","sources":["../../../../apps/ds-playground/src/stories/__tests__/TopBannerInternalActionMenu.test.stories.tsx"],"sourcesContent":["import { useRef, JSX } from 'react';\n\nimport { Meta, StoryObj } from '@storybook/react-vite';\nimport { expect, fireEvent, userEvent, within } from 'storybook/test';\n\nimport { InlineButton } from '@skatteetaten/ds-buttons';\nimport { dsI18n } from '@skatteetaten/ds-core-utils';\nimport {\n  ActionMenuActionsRef,\n  TopBannerInternal,\n} from '@skatteetaten/ds-layout';\n\nconst meta = {\n  component: TopBannerInternal.ActionMenu,\n  title: 'Tester/TopBannerInternal/ActionMenu',\n  argTypes: {\n    children: { control: 'text', table: { disable: true } },\n    id: { table: { disable: true } },\n    className: { table: { disable: true } },\n    lang: { table: { disable: true } },\n    'data-testid': { table: { disable: true } },\n    menuActionsRef: { table: { disable: true } },\n  },\n  args: {\n    children: 'Menu Content',\n  },\n  tags: ['test'],\n  parameters: {\n    imageSnapshot: { disableSnapshot: false },\n  },\n  globals: {\n    backgrounds: {\n      value: 'themePrimary',\n    },\n  },\n} satisfies Meta<typeof TopBannerInternal.ActionMenu>;\n\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nexport const WithAttributes = {\n  name: 'With Attributes',\n  args: {\n    id: 'actionMenuId',\n    className: 'actionMenuClassname',\n    lang: 'en',\n    'data-testid': 'actionMenuTestId',\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const actionMenu = canvas.getByTestId('actionMenuTestId');\n    await expect(actionMenu).toHaveClass('actionMenuClassname');\n    await expect(actionMenu).toHaveAttribute('id', 'actionMenuId');\n    await expect(actionMenu).toHaveAttribute('lang', 'en');\n  },\n  parameters: {\n    a11y: {\n      test: 'off',\n    },\n    imageSnapshot: { disableSnapshot: true },\n  },\n} satisfies Story;\n\nexport const WithRef = {\n  name: 'With Ref (FA1)',\n  args: {\n    ref: (instance: HTMLElement | null): void => {\n      if (instance) {\n        instance.id = 'dummyIdForwardedFromRef';\n      }\n    },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toHaveAttribute('id', 'dummyIdForwardedFromRef');\n  },\n  parameters: {\n    a11y: {\n      test: 'off',\n    },\n    imageSnapshot: { disableSnapshot: true },\n  },\n} satisfies Story;\n\nexport const WithDefaults = {\n  name: 'Defaults',\n  args: {},\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const menuButton = canvas.getByRole('button');\n    await fireEvent.click(menuButton);\n  },\n  parameters: {\n    a11y: {\n      test: 'off',\n    },\n    imageSnapshot: { pseudoStates: ['hover', 'focus-visible', 'active'] },\n  },\n} satisfies Story;\n\nexport const WithImperativeActions = {\n  name: 'With Imperative Actions (A2, A3, A5, A6, B1, C2)',\n  render: (_args): JSX.Element => {\n    const actionsRef = useRef<ActionMenuActionsRef>(null);\n    return (\n      <>\n        <TopBannerInternal.ActionMenu menuActionsRef={actionsRef}>\n          {'Menu Content'}\n          <InlineButton onClick={() => actionsRef?.current?.close?.()}>\n            {'Lukk'}\n          </InlineButton>\n        </TopBannerInternal.ActionMenu>\n        <InlineButton\n          brightness={'light'}\n          className={'marginLeftL'}\n          onClick={() => actionsRef?.current?.open?.()}\n        >\n          {'Åpne'}\n        </InlineButton>\n      </>\n    );\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const buttonText = dsI18n.t('ds_layout:topbannerbutton.Menu');\n    const canvas = within(canvasElement);\n    const menuButton = canvas.getByRole('button', { name: buttonText });\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'false');\n    await fireEvent.click(menuButton);\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'true');\n    const menuContent = canvas.getByText('Menu Content');\n    await expect(menuContent).toBeInTheDocument();\n    const closeButton = canvas.getByText('Lukk');\n    await fireEvent.click(closeButton);\n    await expect(menuContent).not.toBeInTheDocument();\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'false');\n    await expect(menuButton).toHaveFocus();\n    await expect(menuContent).not.toBeInTheDocument();\n    const openButton = canvas.getByText('Åpne');\n    await fireEvent.click(openButton);\n    await expect(canvas.getByText('Menu Content')).toBeInTheDocument();\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'true');\n    await userEvent.keyboard('{Escape}');\n    await expect(menuContent).not.toBeInTheDocument();\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'false');\n    await expect(menuButton).toHaveFocus();\n  },\n  parameters: {\n    a11y: {\n      test: 'off',\n    },\n  },\n} satisfies Story;\n"],"names":["expect","fireEvent","userEvent","within","meta","component","TopBannerInternal","ActionMenu","title","argTypes","children","control","table","disable","id","className","lang","menuActionsRef","args","tags","parameters","imageSnapshot","disableSnapshot","globals","backgrounds","value","WithAttributes","name","play","canvasElement","actionMenu","getByTestId","toHaveClass","toHaveAttribute","a11y","test","WithRef","ref","instance","button","getByRole","WithDefaults","menuButton","click","pseudoStates","WithImperativeActions","render","_args","actionsRef","useRef","jsxs","Fragment","jsx","InlineButton","current","close","open","buttonText","dsI18n","t","canvas","menuContent","getByText","toBeInTheDocument","closeButton","not","toHaveFocus","openButton","keyboard","docs","source","originalSource"],"mappings":"uIAGA,KAAA,CAAA,OAAAA,EAASA,UAAAA,EAAQC,UAAAA,EAAWC,OAAAA,CAAWC,EAAAA,0BASjCC,EAAO,CACXC,UAAWC,EAAkBC,WAC7BC,MAAO,sCACPC,SAAU,CACRC,SAAU,CAAEC,QAAS,OAAQC,MAAO,CAAEC,QAAS,EAAA,CAAK,EACpDC,GAAI,CAAEF,MAAO,CAAEC,QAAS,EAAA,CAAK,EAC7BE,UAAW,CAAEH,MAAO,CAAEC,QAAS,EAAA,CAAK,EACpCG,KAAM,CAAEJ,MAAO,CAAEC,QAAS,EAAA,CAAK,EAC/B,cAAe,CAAED,MAAO,CAAEC,QAAS,EAAA,CAAK,EACxCI,eAAgB,CAAEL,MAAO,CAAEC,QAAS,EAAA,CAAK,CAAE,EAE7CK,KAAM,CACJR,SAAU,cAAA,EAEZS,KAAM,CAAC,MAAM,EACbC,WAAY,CACVC,cAAe,CAAEC,gBAAiB,EAAA,CAAM,EAE1CC,QAAS,CACPC,YAAa,CACXC,MAAO,cAAA,CACT,CAEJ,EAKaC,EAAiB,CAC5BC,KAAM,kBACNT,KAAM,CACJJ,GAAI,eACJC,UAAW,sBACXC,KAAM,KACN,cAAe,kBAAA,EAEjBY,KAAM,MAAO,CAAEC,cAAAA,CAAAA,IAAmC,CAEhD,MAAMC,EADS3B,EAAO0B,CAAa,EACTE,YAAY,kBAAkB,EACxD,MAAM/B,EAAO8B,CAAU,EAAEE,YAAY,qBAAqB,EAC1D,MAAMhC,EAAO8B,CAAU,EAAEG,gBAAgB,KAAM,cAAc,EAC7D,MAAMjC,EAAO8B,CAAU,EAAEG,gBAAgB,OAAQ,IAAI,CACvD,EACAb,WAAY,CACVc,KAAM,CACJC,KAAM,KAAA,EAERd,cAAe,CAAEC,gBAAiB,EAAA,CAAK,CAE3C,EAEac,EAAU,CACrBT,KAAM,iBACNT,KAAM,CACJmB,IAAMC,GAAuC,CACvCA,IACFA,EAASxB,GAAK,0BAElB,CAAA,EAEFc,KAAM,MAAO,CAAEC,cAAAA,CAAAA,IAAmC,CAEhD,MAAMU,EADSpC,EAAO0B,CAAa,EACbW,UAAU,QAAQ,EACxC,MAAMxC,EAAOuC,CAAM,EAAEN,gBAAgB,KAAM,yBAAyB,CACtE,EACAb,WAAY,CACVc,KAAM,CACJC,KAAM,KAAA,EAERd,cAAe,CAAEC,gBAAiB,EAAA,CAAK,CAE3C,EAEamB,EAAe,CAC1Bd,KAAM,WACNT,KAAM,CAAA,EACNU,KAAM,MAAO,CAAEC,cAAAA,CAAAA,IAAmC,CAEhD,MAAMa,EADSvC,EAAO0B,CAAa,EACTW,UAAU,QAAQ,EAC5C,MAAMvC,EAAU0C,MAAMD,CAAU,CAClC,EACAtB,WAAY,CACVc,KAAM,CACJC,KAAM,KAAA,EAERd,cAAe,CAAEuB,aAAc,CAAC,QAAS,gBAAiB,QAAQ,CAAA,CAAE,CAExE,EAEaC,EAAwB,CACnClB,KAAM,mDACNmB,OAASC,GAAuB,CAC9B,MAAMC,EAAaC,EAAAA,OAA6B,IAAI,EACpD,OACEC,EAAAA,KAAAC,WAAA,CACE,SAAA,CAAAD,EAAAA,KAAC5C,EAAkB,WAAlB,CAA6B,eAAgB0C,EAC3C,SAAA,CAAA,eACDI,MAACC,GAAa,QAAS,IAAML,GAAYM,SAASC,QAAAA,EAC/C,SAAA,MAAA,CACH,CAAA,EACF,EACAH,EAAAA,IAACC,EAAA,CACC,WAAY,QACZ,UAAW,cACX,QAAS,IAAML,GAAYM,SAASE,OAAAA,EAEnC,SAAA,MAAA,CACH,CAAA,EACF,CAEJ,EACA5B,KAAM,MAAO,CAAEC,cAAAA,CAAAA,IAAmC,CAChD,MAAM4B,EAAaC,EAAOC,EAAE,gCAAgC,EACtDC,EAASzD,EAAO0B,CAAa,EAC7Ba,EAAakB,EAAOpB,UAAU,SAAU,CAAEb,KAAM8B,CAAAA,CAAY,EAClE,MAAMzD,EAAO0C,CAAU,EAAET,gBAAgB,gBAAiB,OAAO,EACjE,MAAMhC,EAAU0C,MAAMD,CAAU,EAChC,MAAM1C,EAAO0C,CAAU,EAAET,gBAAgB,gBAAiB,MAAM,EAChE,MAAM4B,EAAcD,EAAOE,UAAU,cAAc,EACnD,MAAM9D,EAAO6D,CAAW,EAAEE,kBAAAA,EAC1B,MAAMC,EAAcJ,EAAOE,UAAU,MAAM,EAC3C,MAAM7D,EAAU0C,MAAMqB,CAAW,EACjC,MAAMhE,EAAO6D,CAAW,EAAEI,IAAIF,kBAAAA,EAC9B,MAAM/D,EAAO0C,CAAU,EAAET,gBAAgB,gBAAiB,OAAO,EACjE,MAAMjC,EAAO0C,CAAU,EAAEwB,YAAAA,EACzB,MAAMlE,EAAO6D,CAAW,EAAEI,IAAIF,kBAAAA,EAC9B,MAAMI,EAAaP,EAAOE,UAAU,MAAM,EAC1C,MAAM7D,EAAU0C,MAAMwB,CAAU,EAChC,MAAMnE,EAAO4D,EAAOE,UAAU,cAAc,CAAC,EAAEC,kBAAAA,EAC/C,MAAM/D,EAAO0C,CAAU,EAAET,gBAAgB,gBAAiB,MAAM,EAChE,MAAM/B,EAAUkE,SAAS,UAAU,EACnC,MAAMpE,EAAO6D,CAAW,EAAEI,IAAIF,kBAAAA,EAC9B,MAAM/D,EAAO0C,CAAU,EAAET,gBAAgB,gBAAiB,OAAO,EACjE,MAAMjC,EAAO0C,CAAU,EAAEwB,YAAAA,CAC3B,EACA9C,WAAY,CACVc,KAAM,CACJC,KAAM,KAAA,CACR,CAEJ,EAAiBT,EAAAN,WAAA,CAAA,GAAAM,EAAAN,WAAAiD,KAAA,CAAA,GAAA3C,EAAAN,YAAAiD,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,GAAA7C,EAAAN,YAAAiD,MAAAC,MAAAA,CAAA,CAAA,EAAAlC,EAAAhB,WAAA,CAAA,GAAAgB,EAAAhB,WAAAiD,KAAA,CAAA,GAAAjC,EAAAhB,YAAAiD,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,GAAAnC,EAAAhB,YAAAiD,MAAAC,MAAAA,CAAA,CAAA,EAAA7B,EAAArB,WAAA,CAAA,GAAAqB,EAAArB,WAAAiD,KAAA,CAAA,GAAA5B,EAAArB,YAAAiD,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,GAAA9B,EAAArB,YAAAiD,MAAAC,MAAAA,CAAA,CAAA,EAAAzB,EAAAzB,WAAA,CAAA,GAAAyB,EAAAzB,WAAAiD,KAAA,CAAA,GAAAxB,EAAAzB,YAAAiD,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,GAAA1B,EAAAzB,YAAAiD,MAAAC,MAAAA,CAAA,CAAA"}