{"version":3,"file":"TopBannerInternalActionMenu.test.stories-PA2rKZnl.js","sources":["../../../../apps/ds-playground/src/stories/__tests__/TopBannerInternalActionMenu.test.stories.tsx"],"sourcesContent":["import { useRef, JSX } from 'react';\n\nimport { Meta, StoryObj } from '@storybook/react';\nimport { expect, fireEvent, userEvent, within } from '@storybook/test';\n\nimport { InlineButton } from '@skatteetaten/ds-buttons';\nimport { dsI18n } from '@skatteetaten/ds-core-utils';\nimport {\n  ActionMenuActionsRef,\n  TopBannerInternal,\n} from '@skatteetaten/ds-layout';\n\nimport { wrapper } from './testUtils/storybook.testing.utils';\n\nconst meta = {\n  component: TopBannerInternal.ActionMenu,\n  title: 'Tester/TopBanner/TopBannerInternalActionMenu',\n  argTypes: {\n    children: { control: 'text', table: { disable: true } },\n    id: { table: { disable: true } },\n    className: { table: { disable: true } },\n    lang: { table: { disable: true } },\n    'data-testid': { table: { disable: true } },\n    menuActionsRef: { table: { disable: true } },\n  },\n  args: {\n    children: 'Menu Content',\n  },\n  parameters: {\n    backgrounds: { default: 'themePrimary' },\n  },\n} satisfies Meta<typeof TopBannerInternal.ActionMenu>;\n\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nexport const WithAttributes = {\n  name: 'With Attributes',\n  args: {\n    id: 'actionMenuId',\n    className: 'actionMenuClassname',\n    lang: 'en',\n    'data-testid': 'actionMenuTestId',\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const actionMenu = canvas.getByTestId('actionMenuTestId');\n    await expect(actionMenu).toHaveClass('actionMenuClassname');\n    await expect(actionMenu).toHaveAttribute('id', 'actionMenuId');\n    await expect(actionMenu).toHaveAttribute('lang', 'en');\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n} satisfies Story;\n\nexport const WithRef = {\n  name: 'With Ref (FA1)',\n  args: {\n    ref: (instance: HTMLElement | null): void => {\n      if (instance) {\n        instance.id = 'dummyIdForwardedFromRef';\n      }\n    },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toHaveAttribute('id', 'dummyIdForwardedFromRef');\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n} satisfies Story;\n\nexport const WithImperativeActions = {\n  name: 'With Imperative Actions (A2, A3, A5, A6, B1, C2)',\n  render: (_args): JSX.Element => {\n    const actionsRef = useRef<ActionMenuActionsRef>(null);\n    return (\n      <>\n        <TopBannerInternal.ActionMenu menuActionsRef={actionsRef}>\n          {'Menu Content'}\n          <InlineButton onClick={() => actionsRef?.current?.close?.()}>\n            {'Lukk'}\n          </InlineButton>\n        </TopBannerInternal.ActionMenu>\n        <InlineButton\n          brightness={'light'}\n          className={'marginLeftL'}\n          onClick={() => actionsRef?.current?.open?.()}\n        >\n          {'Åpne'}\n        </InlineButton>\n      </>\n    );\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const buttonText = dsI18n.t('ds_layout:topbannerbutton.Menu');\n    const canvas = within(canvasElement);\n    const menuButton = canvas.getByRole('button', { name: buttonText });\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'false');\n    await fireEvent.click(menuButton);\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'true');\n    const menuContent = canvas.getByText('Menu Content');\n    await expect(menuContent).toBeInTheDocument();\n    const closeButton = canvas.getByText('Lukk');\n    await fireEvent.click(closeButton);\n    await expect(menuContent).not.toBeInTheDocument();\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'false');\n    await expect(menuButton).toHaveFocus();\n    await expect(menuContent).not.toBeInTheDocument();\n    const openButton = canvas.getByText('Åpne');\n    await fireEvent.click(openButton);\n    await expect(canvas.getByText('Menu Content')).toBeInTheDocument();\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'true');\n    await userEvent.keyboard('{Escape}');\n    await expect(menuContent).not.toBeInTheDocument();\n    await expect(menuButton).toHaveAttribute('aria-expanded', 'false');\n    await expect(menuButton).toHaveFocus();\n  },\n  parameters: {\n    imageSnapshot: {\n      click: `${wrapper} > :first-child`,\n    },\n  },\n} satisfies Story;\n"],"names":["meta","component","TopBannerInternal","ActionMenu","title","argTypes","children","control","table","disable","id","className","lang","menuActionsRef","args","parameters","backgrounds","default","WithAttributes","name","play","canvasElement","actionMenu","within","getByTestId","expect","toHaveClass","toHaveAttribute","imageSnapshot","WithRef","ref","instance","button","getByRole","WithImperativeActions","render","_args","actionsRef","useRef","jsxs","Fragment","jsx","InlineButton","current","close","open","buttonText","dsI18n","t","canvas","menuButton","fireEvent","click","menuContent","getByText","toBeInTheDocument","closeButton","not","toHaveFocus","openButton","userEvent","keyboard","wrapper","docs","source","originalSource"],"mappings":"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"}