{"version":3,"file":"PopoverTrigger.test.stories-D05J6J26.js","sources":["../../../../apps/ds-playground/src/stories/__tests__/PopoverTrigger.test.stories.tsx"],"sourcesContent":["import { JSX } from 'react';\n\nimport { Popover } from '@skatteetaten/ds-overlays';\nimport { Meta, StoryObj } from '@storybook/react';\nimport { expect, fn, userEvent, waitFor, within } from '@storybook/test';\n\nimport { category, htmlEventDescription } from '../../../.storybook/helpers';\nimport { SystemSVGPaths } from '../utils/icon.systems';\n\nconst verifyAttribute =\n  (attribute: string, expectedValue: string) =>\n  async ({ canvasElement }: { canvasElement: HTMLElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const iconButton = canvas.getByRole('button');\n    await expect(iconButton).toBeInTheDocument();\n    await expect(iconButton).toHaveAttribute(attribute, expectedValue);\n  };\n\nconst meta = {\n  component: Popover.Trigger,\n  title: 'Tester/Popover/Trigger',\n  argTypes: {\n    // Baseprops\n    key: { table: { disable: true } },\n    ref: { table: { disable: true } },\n    className: { table: { disable: true } },\n    id: { table: { disable: true } },\n    lang: { table: { disable: true } },\n    'data-testid': { table: { disable: true } },\n    // Props\n    size: { table: { disable: true } },\n    svgPath: {\n      options: Object.keys(SystemSVGPaths),\n      mapping: SystemSVGPaths,\n      table: { disable: true },\n    },\n    //HTML\n    title: { table: { category: category.htmlAttribute, disable: true } },\n    // Aria\n    ariaDescribedby: { table: { category: category.aria, disable: true } },\n    //Events\n    onFocus: { ...htmlEventDescription, table: { disable: true } },\n    onClick: { ...htmlEventDescription, table: { disable: true } },\n    onBlur: { ...htmlEventDescription, table: { disable: true } },\n  },\n  render: (args): JSX.Element => (\n    <Popover>\n      <Popover.Trigger {...args} />\n    </Popover>\n  ),\n} satisfies Meta<typeof Popover.Trigger>;\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nexport const WithRef = {\n  name: 'With Ref (FA1)',\n  args: {\n    ref: (instance: HTMLButtonElement | null): void => {\n      if (instance) {\n        instance.id = 'dummyIdForwardedFromRef';\n      }\n    },\n  },\n  argTypes: {\n    ref: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toHaveAttribute('id', 'dummyIdForwardedFromRef');\n  },\n} satisfies Story;\n\nexport const WithAttributes = {\n  name: 'With Attributes (FA2-5)',\n  args: {\n    id: 'htmlId',\n    className: 'dummyClassname',\n    lang: 'en',\n    'data-testid': '123ID',\n  },\n  argTypes: {\n    id: { table: { disable: false } },\n    className: { table: { disable: false } },\n    lang: { table: { disable: false } },\n    'data-testid': { table: { disable: false } },\n  },\n  play: async ({ canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const button = canvas.getByRole('button');\n    await expect(button).toHaveAttribute('id', 'htmlId');\n    await expect(button).toHaveClass('dummyClassname');\n    await expect(button).toHaveAttribute('lang', 'en');\n    await expect(button).toHaveAttribute('data-testid', '123ID');\n  },\n} satisfies Story;\n\nexport const WithAriaDescribedby = {\n  name: 'With AriaDescribedby',\n  args: {\n    ariaDescribedby: 'araiDescId',\n  },\n  argTypes: {\n    ariaDescribedby: { table: { disable: false } },\n  },\n  parameters: {\n    imageSnapshot: {\n      disable: true,\n    },\n  },\n  play: verifyAttribute('aria-describedby', 'araiDescId'),\n} satisfies Story;\n\nexport const WithEventHandlers = {\n  name: 'With EventHandlers',\n  args: {\n    onFocus: fn(),\n    onBlur: fn(),\n    onClick: fn(),\n  },\n  parameters: {\n    imageSnapshot: { disable: true },\n  },\n  play: async ({ args, canvasElement }): Promise<void> => {\n    const canvas = within(canvasElement);\n    const iconButton = canvas.getByRole('button');\n    await expect(iconButton).toBeInTheDocument();\n    iconButton.focus();\n    await waitFor(() => expect(args.onFocus).toHaveBeenCalled());\n    await userEvent.tab();\n    await waitFor(() => expect(args.onBlur).toHaveBeenCalled());\n    await userEvent.click(iconButton);\n    await waitFor(() => expect(args.onClick).toHaveBeenCalled());\n  },\n} satisfies Story;\n"],"names":["verifyAttribute","attribute","expectedValue","canvasElement","iconButton","within","getByRole","expect","toBeInTheDocument","toHaveAttribute","meta","component","Popover","Trigger","title","argTypes","key","table","disable","ref","className","id","lang","size","svgPath","options","Object","keys","SystemSVGPaths","mapping","category","htmlAttribute","ariaDescribedby","aria","onFocus","htmlEventDescription","onClick","onBlur","render","args","jsx","WithRef","name","instance","parameters","imageSnapshot","play","button","WithAttributes","toHaveClass","WithAriaDescribedby","WithEventHandlers","fn","focus","waitFor","toHaveBeenCalled","userEvent","tab","click","docs","source","originalSource"],"mappings":"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"}