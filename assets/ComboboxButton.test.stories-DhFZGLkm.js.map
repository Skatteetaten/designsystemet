{"version":3,"file":"ComboboxButton.test.stories-DhFZGLkm.js","sources":["../../../../apps/ds-playground/src/stories/__tests__/combobox/ComboboxButton.test.stories.tsx"],"sourcesContent":["import React, { JSX } from 'react';\n\nimport { Meta, StoryObj } from '@storybook/react-vite';\nimport { expect, fn, userEvent, waitFor, within } from 'storybook/test';\n\nimport { dsI18n } from '@skatteetaten/ds-core-utils';\n\n// eslint-disable-next-line @nx/enforce-module-boundaries\nimport { ComboboxButton } from '../../../../../../libs/ds-forms/src/Combobox/ComboboxButton';\n\ntype ComboboxButtonProps = React.ComponentProps<typeof ComboboxButton>;\n\nconst meta = {\n  component: ComboboxButton,\n  title: 'Tester/Combobox/Button',\n  decorators: [(Story): JSX.Element => <Story />],\n  argTypes: {\n    // Props\n    isOpen: { table: { disable: true } },\n    hasValue: { table: { disable: true } },\n    multiple: { table: { disable: true } },\n    disabled: { table: { disable: true } },\n    variant: { table: { disable: true } },\n    onClear: { table: { disable: true } },\n    onClick: { table: { disable: true } },\n  },\n  tags: ['test'],\n} satisfies Meta<typeof ComboboxButton>;\n\nexport default meta;\ntype Story = StoryObj<typeof meta>;\n\nconst defaultArgs = {\n  isOpen: false,\n  onClick: fn(),\n};\n\nexport const ClearButtonClick = {\n  name: 'Clear button click handler (A9, B2)',\n  args: {\n    ...defaultArgs,\n    multiple: false,\n    hasValue: true,\n    onClear: fn(),\n  },\n  play: async ({\n    args,\n    canvasElement,\n  }: {\n    args: ComboboxButtonProps;\n    canvasElement: HTMLElement;\n  }): Promise<void> => {\n    const canvas = within(canvasElement);\n\n    const clearButton = canvas.getByRole('button', {\n      name: dsI18n.t('ds_forms:combobox.ResetSuggestion'),\n    });\n    await userEvent.click(clearButton);\n    await waitFor(() => expect(args.onClear).toHaveBeenCalled());\n  },\n} satisfies Story;\n\nexport const DisabledStateHandling = {\n  name: 'Disabled state handling',\n  args: {\n    ...defaultArgs,\n    disabled: true,\n    onClick: fn(),\n  },\n  play: async ({\n    args,\n    canvasElement,\n  }: {\n    args: ComboboxButtonProps;\n    canvasElement: HTMLElement;\n  }): Promise<void> => {\n    const chevron = canvasElement.querySelector('div[class*=\"chevronButton\"]');\n    await expect(chevron).toHaveStyle('pointer-events: none');\n\n    // Prøv å trigge click event direkte (simulerer en programmatisk klikk)\n    if (chevron) {\n      chevron.dispatchEvent(new Event('click', { bubbles: true }));\n    }\n    await expect(args.onClick).not.toHaveBeenCalled();\n  },\n} satisfies Story;\n"],"names":["expect","fn","userEvent","waitFor","within","meta","component","ComboboxButton","title","decorators","Story","jsx","argTypes","isOpen","table","disable","hasValue","multiple","disabled","variant","onClear","onClick","tags","defaultArgs","ClearButtonClick","name","args","play","canvasElement","clearButton","getByRole","dsI18n","t","click","toHaveBeenCalled","DisabledStateHandling","chevron","querySelector","toHaveStyle","dispatchEvent","Event","bubbles","not","parameters","docs","source","originalSource"],"mappings":"wMAGA,KAAA,CAAA,OAAAA,EAASA,GAAAA,EAAQC,UAAAA,EAAIC,QAAAA,EAAWC,OAAAA,CAASC,EAAAA,0BASnCC,EAAO,CACXC,UAAWC,EACXC,MAAO,yBACPC,WAAY,CAAEC,GAAuBC,EAAAA,IAACD,KAAQ,EAC9CE,SAAU,CAERC,OAAQ,CAAEC,MAAO,CAAEC,QAAS,EAAA,CAAK,EACjCC,SAAU,CAAEF,MAAO,CAAEC,QAAS,EAAA,CAAK,EACnCE,SAAU,CAAEH,MAAO,CAAEC,QAAS,EAAA,CAAK,EACnCG,SAAU,CAAEJ,MAAO,CAAEC,QAAS,EAAA,CAAK,EACnCI,QAAS,CAAEL,MAAO,CAAEC,QAAS,EAAA,CAAK,EAClCK,QAAS,CAAEN,MAAO,CAAEC,QAAS,EAAA,CAAK,EAClCM,QAAS,CAAEP,MAAO,CAAEC,QAAS,EAAA,CAAK,CAAE,EAEtCO,KAAM,CAAC,MAAM,CACf,EAKMC,EAAc,CAClBV,OAAQ,GACRQ,QAASpB,EAAAA,CACX,EAEauB,EAAmB,CAC9BC,KAAM,sCACNC,KAAM,CACJ,GAAGH,EACHN,SAAU,GACVD,SAAU,GACVI,QAASnB,EAAAA,CAAG,EAEd0B,KAAM,MAAO,CACXD,KAAAA,EACAE,cAAAA,CAAAA,IAImB,CAGnB,MAAMC,EAFSzB,EAAOwB,CAAa,EAERE,UAAU,SAAU,CAC7CL,KAAMM,EAAOC,EAAE,mCAAmC,CAAA,CACnD,EACD,MAAM9B,EAAU+B,MAAMJ,CAAW,EACjC,MAAM1B,EAAQ,IAAMH,EAAO0B,EAAKN,OAAO,EAAEc,kBAAkB,CAC7D,CACF,EAEaC,EAAwB,CACnCV,KAAM,0BACNC,KAAM,CACJ,GAAGH,EACHL,SAAU,GACVG,QAASpB,EAAAA,CAAG,EAEd0B,KAAM,MAAO,CACXD,KAAAA,EACAE,cAAAA,CAAAA,IAImB,CACnB,MAAMQ,EAAUR,EAAcS,cAAc,6BAA6B,EACzE,MAAMrC,EAAOoC,CAAO,EAAEE,YAAY,sBAAsB,EAGpDF,GACFA,EAAQG,cAAc,IAAIC,MAAM,QAAS,CAAEC,QAAS,EAAA,CAAM,CAAC,EAE7D,MAAMzC,EAAO0B,EAAKL,OAAO,EAAEqB,IAAIR,iBAAAA,CACjC,CACF,EAAiBV,EAAAmB,WAAA,CAAA,GAAAnB,EAAAmB,WAAAC,KAAA,CAAA,GAAApB,EAAAmB,YAAAC,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,GAAAtB,EAAAmB,YAAAC,MAAAC,MAAAA,CAAA,CAAA,EAAAV,EAAAQ,WAAA,CAAA,GAAAR,EAAAQ,WAAAC,KAAA,CAAA,GAAAT,EAAAQ,YAAAC,KAAAC,OAAA,CAAAC,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAAA,GAAAX,EAAAQ,YAAAC,MAAAC,MAAAA,CAAA,CAAA"}